"use strict";(self.webpackChunkelemental_docs=self.webpackChunkelemental_docs||[]).push([[7956],{4828:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>f,frontMatter:()=>c,metadata:()=>l,toc:()=>m});var i=t(17624),a=t(4552),s=t(98420),r=t(25276),o=t(37612);const c={sidebar_label:"Authentication",title:""},d="Authentication",l={id:"authentication",title:"",description:"Authentication happens during Machine onboarding, when the Machine registers to the",source:"@site/docs/authentication.md",sourceDirName:".",slug:"/authentication",permalink:"/next/authentication",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{sidebar_label:"Authentication",title:""},sidebar:"docs",previous:{title:"Elemental plans",permalink:"/next/elemental-plans"},next:{title:"Cloud-config reference",permalink:"/next/cloud-config-reference"}},h={},m=[{value:"TPM alternatives",id:"tpm-alternatives",level:2},{value:"TPM emulation",id:"tpm-emulation",level:3},{value:"MAC address identification",id:"mac-address-identification",level:3},{value:"SMBIOS UUID identification",id:"smbios-uuid-identification",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",strong:"strong",ul:"ul",...(0,a.M)(),...e.components},{CodeBlock:t,Head:c,Vars:d}=n;return t||p("CodeBlock",!0),c||p("Head",!0),d||p("Vars",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c,{children:(0,i.jsx)("link",{rel:"canonical",href:"https://elemental.docs.rancher.com/authentication"})}),"\n","\n","\n",(0,i.jsx)(n.h1,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["Authentication happens during Machine onboarding, when the Machine ",(0,i.jsx)(n.em,{children:"registers"})," to the\n",(0,i.jsx)(d,{name:"elemental_operator_name"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Elemental by default authenticates hosts through the ",(0,i.jsx)(n.em,{children:"Trusted Platform Module"})," (TPM):\nthe machine is authenticated through ",(0,i.jsx)(n.em,{children:"attestation"}),", i.e., the machine proofs its identity through its\nTPM device."]}),"\n",(0,i.jsxs)(n.p,{children:["In order for ",(0,i.jsx)(n.em,{children:"attestation"})," to work, each onboarding machine\n",(0,i.jsx)(n.strong,{children:"must have a TPM 2.0 device"}),",\notherwise would not be able to register using secure TPM authentication."]}),"\n",(0,i.jsx)(n.h2,{id:"tpm-alternatives",children:"TPM alternatives"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"The only officially supported registration method is based on TPM attestation and requires devices TPM 2.0 enabled."})}),"\n",(0,i.jsxs)(n.p,{children:["If you want to enroll devices without a TPM 2.0 chip bypassing secure authentication, there are multiple ways to uniquely ",(0,i.jsx)(n.em,{children:"identify"})," those machines and allow registration:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"emulating a TPM device via a simple software implementation"}),"\n",(0,i.jsx)(n.li,{children:"identifying themselves through their network MAC address"}),"\n",(0,i.jsx)(n.li,{children:"identifying themselves using their SMBIOS UUID"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The authentication/identification method can be specified in the\n",(0,i.jsxs)(n.a,{href:"/next/machineregistration-reference#configelementalregistration",children:["config:elemental:registration",":auth"," field"]})," of the MachineRegistration resource."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["The only secure and officially supported ",(0,i.jsx)(n.strong,{children:"authentication"})," method in Elemental is the default one, based on TPM attestation.\nThe TPM alternatives can be used for demo purposes or local deployments but are not reccomended for production use as the onboarding machines identity is not securely verified."]})}),"\n",(0,i.jsx)(n.h3,{id:"tpm-emulation",children:"TPM emulation"}),"\n",(0,i.jsxs)(n.p,{children:["TPM emulation performs authentication using a software that mimics TPM behavior and which is embedded in the ",(0,i.jsx)(d,{name:"elemental_register_name"}),".\nThe keys of the emulated TPM device are all generated by a single seed in a deterministic way: same seed results in the same TPM keys, so a different seed should be picked up in each enrolling host."]}),"\n",(0,i.jsxs)(n.p,{children:["TPM emulation is enabled configuring the ",(0,i.jsx)(n.code,{children:"emulate-tpm"})," and ",(0,i.jsx)(n.code,{children:"emulated-tpm-seed"})," fields in the ",(0,i.jsx)(n.code,{children:"MachineRegistration"})," configuration (see the ",(0,i.jsxs)(n.a,{href:"/next/machineregistration-reference#configelementalregistration",children:["config:elemental",":registration"," section in the MachineRegistration reference"]})," for more details)."]}),"\n",(0,i.jsx)(t,{language:"yaml",title:"example MachineRegistration using TPM emulation",showLineNumbers:!0,children:s.c}),"\n",(0,i.jsxs)(n.p,{children:["TPM emulation configuration is detailed in the ",(0,i.jsx)(n.a,{href:"/next/tpm#add-tpm-emulation-to-bare-metal-machine",children:"TPM emulation configuration section"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"mac-address-identification",children:"MAC address identification"}),"\n",(0,i.jsxs)(n.p,{children:["When using MAC address identification, the host registers to the ",(0,i.jsx)(d,{name:"elemental_operator_name"})," using the MAC address from its Network Interface Card (NIC) as an identifier.\nIn case the machine has more than one network interface, the MAC addresses are sorted lexicographically and the first one is selected."]}),"\n",(0,i.jsxs)(n.p,{children:["To replace TPM authentication with MAC address identification, it is enough to set the ",(0,i.jsx)(n.code,{children:"mac"})," value to the ",(0,i.jsx)(n.code,{children:"auth"})," field in the ",(0,i.jsxs)(n.a,{href:"/next/machineregistration-reference#configelementalregistration",children:["config:elemental",":registration"," section in the MachineRegistration reference"]}),"."]}),"\n",(0,i.jsx)(t,{language:"yaml",title:"example MachineRegistration using the MAC address as machine identifier",showLineNumbers:!0,children:r.c}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["The MAC address is considered unique by the ",(0,i.jsx)(d,{name:"elemental_operator_name"}),".\nThis is true for phisical devices, while if using VirtualMachines from different hypervisors and different network segments it is up to the administrator to ensure that the registering VMs have a unique MAC address."]})}),"\n",(0,i.jsx)(n.h3,{id:"smbios-uuid-identification",children:"SMBIOS UUID identification"}),"\n",(0,i.jsx)(n.p,{children:"The System Management BIOS (SMBIOS) specification defines data structures that can be used to read management information produced by the BIOS of a host."}),"\n",(0,i.jsxs)(n.p,{children:["When using the ",(0,i.jsx)(n.code,{children:"sys-uuid"})," value as the ",(0,i.jsx)(n.code,{children:"auth"})," field of the ",(0,i.jsxs)(n.a,{href:"/next/machineregistration-reference#configelementalregistration",children:["config:elemental",":registration"," section in the MachineRegistration"]}),", the host registers to the ",(0,i.jsx)(d,{name:"elemental_operator_name"})," using the ",(0,i.jsx)(n.code,{children:"UUID"})," value from the ",(0,i.jsx)(n.code,{children:"System Information"})," table of the host SMBIOS data."]}),"\n",(0,i.jsx)(t,{language:"yaml",title:"example MachineRegistration using the UUID from the SMBIOS System Information table as machine identifier",showLineNumbers:!0,children:o.c}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.p,{children:["The SMBIOS ",(0,i.jsx)(n.code,{children:"System information/UUID"})," value should be filled by the hardware vendor as a unique UUID for the host."]}),(0,i.jsx)(n.p,{children:"The SMBIOS data is not always reliable. This depends on the manufacturer. You may experience the UUID being missing, or the same UUID being applied to multiple devices within the same batch."}),(0,i.jsxs)(n.p,{children:["It is up to the administrator to ensure that the machines have unique ",(0,i.jsx)(n.code,{children:"System information/UUID"})," SMBIOS values (the  ",(0,i.jsx)(n.code,{children:"dmidecode"})," tool could be of help), otherwise the machines will keep overwriting the same ",(0,i.jsx)(n.code,{children:"MachineInventory"})," resource and the Elemental provisioning will fail."]})]})]})}function f(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}function p(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},98420:(e,n,t)=>{t.d(n,{c:()=>i});const i='apiVersion: elemental.cattle.io/v1beta1\nkind: MachineRegistration\nmetadata:\n  name: fire-nodes-emulate-tpm\n  namespace: fleet-default\nspec:\n  config:\n    cloud-config:\n      users:\n        - name: root\n          passwd: root\n    elemental:\n      install:\n        reboot: true\n        device: /dev/sda\n        debug: true\n      registration:\n        emulate-tpm: true\n        emulated-tpm-seed: -1\n  machineInventoryLabels:\n    element: fire\n    manufacturer: "${System Information/Manufacturer}"\n    productName: "${System Information/Product Name}"\n    serialNumber: "${System Information/Serial Number}"\n    machineUUID: "${System Information/UUID}"\n'},25276:(e,n,t)=>{t.d(n,{c:()=>i});const i='apiVersion: elemental.cattle.io/v1beta1\nkind: MachineRegistration\nmetadata:\n  name: fire-nodes-mac\n  namespace: fleet-default\nspec:\n  config:\n    cloud-config:\n      users:\n        - name: root\n          passwd: root\n    elemental:\n      install:\n        reboot: true\n        device: /dev/sda\n        debug: true\n      registration:\n        auth: mac\n  machineInventoryLabels:\n    element: fire\n    manufacturer: "${System Information/Manufacturer}"\n    productName: "${System Information/Product Name}"\n    serialNumber: "${System Information/Serial Number}"\n    machineUUID: "${System Information/UUID}"\n'},37612:(e,n,t)=>{t.d(n,{c:()=>i});const i='apiVersion: elemental.cattle.io/v1beta1\nkind: MachineRegistration\nmetadata:\n  name: fire-nodes-mac\n  namespace: fleet-default\nspec:\n  config:\n    cloud-config:\n      users:\n        - name: root\n          passwd: root\n    elemental:\n      install:\n        reboot: true\n        device: /dev/sda\n        debug: true\n      registration:\n        auth: sys-uuid\n  machineInventoryLabels:\n    element: fire\n    manufacturer: "${System Information/Manufacturer}"\n    productName: "${System Information/Product Name}"\n    serialNumber: "${System Information/Serial Number}"\n    machineUUID: "${System Information/UUID}"\n'},4552:(e,n,t)=>{t.d(n,{I:()=>o,M:()=>r});var i=t(11504);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);